{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https:cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"> </script>
    <!-- Favicons -->
    <link href="{% static 'website/img/favicon.ico' %}" rel="icon">
    <link href="{% static 'website/img/apple-touch-icon.ico' %}" rel="apple-touch-icon">

    <!-- Bootstrap core CSS -->
    <link href="{% static 'website/lib/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
    <!--external css-->
    <link href="{% static 'website/lib/font-awesome/css/font-awesome.css' %}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{% static '/website/css/zabuto_calendar.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static '/website/lib/gritter/css/jquery.gritter.css' %}" />
    <!-- Custom styles for this template -->
    <link href="{% static 'website/css/styles.css' %}" rel="stylesheet">
    
    <link href="{% static '/website/css/font.css' %}" rel="stylesheet">
    <link href="{% static 'website/css/style-responsive.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'website/lib/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'website/lib/DataTables/css/mdb.min.css' %}">
    <link rel="stylesheet" href="{% static 'website/lib/bootstrap/css/ModifiedBootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'website/lib/DataTables/css/dataTables.bootstrap4.min.css' %}">
    <script src="{% static 'website/lib/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'website/lib/DataTables/js/popper.min.js' %}"></script>
    <script src="{% static 'website/lib/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'website/lib/DataTables/js/mdb.min.js' %}"></script>
    
</head>
<body onload="show()">
  <section id="container">

    <!--Header Start-->
    <header class="header black-bg">
        <div class="sidebar-toggle-box">
            <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
        </div>
        <!--logo start-->
        <a href="" class="logo"><b>Ginatilan Water Billing<span> Station</span></b></a>
        <!--logo end-->
        
        <div class="top-menu">
            <ul class="nav pull-right top-menu">                 
                <li><a class="logout" href="/logout">Logout</a></li>                    
            </ul>
        </div>
   
    </header>
    <!--Header End-->
    <!--sidebar start-->
    <aside>
      <div id="sidebar" class="nav-collapse ">
          <!-- sidebar menu start-->
          <ul class="sidebar-menu" id="nav-accordion">
              <p class="centered"><a href=""><img src="{% static 'website/img/ui-admin.jpg' %}" class="img-circle" width="80"></a></p>
              <h5 class="centered">{{ context.name }}</h5>

              
              
              <div id="manage_account" >
              <li class="sub-menu" >
                  <a href="">
                      <i class="fa fa-address-book"></i>
                      <span>Manage Accounts</span>
                  </a>
                  <ul class="sub">
                      <li><a href="/source_access/add_new_consumer">Add / View Consumer List</a></li>
                      <li><a href="/source_access/view-suspended-account">Reactivate Account</a></li>
                      <li><a href="/source_access/Payment">Payments</a></li>
                  </ul>
              </li>
              </div>

              <div id="input_reading" >
                  <li class="sub-menu" >
                      <a href="/source_access/add-meter-reading">
                          <i class="fa fa-calculator"></i>
                          <span>Input Reading</span>
                      </a>
                  </li>
              </div>

              <div id="reports" >

               <li class="sub-menu" >
                  <a class="active" href="">
                      <i class="fa fa-newspaper-o"></i>
                      <span>Reports</span>
                  </a>
                  <ul class="sub">
                      <li><a href="/source_access/report-data">Revenue Report</a></li>
                      <li><a href="/source_access/pending_bills">Unsettled Bills</a></li>
                  </ul>
              </li>
              </div>

              

              <div id="application" >
              <li class="sub-menu" >
                  <a href="">
                      <i class="fa fa-user-plus"></i>
                      <span>Approve Application</span>
                  </a>
                  <ul class="sub">
                      <li><a href="/source_access/list-applicants">Application Request</a></li>
                      <li><a href="">Declined Applicants</a></li>
                  </ul>
              </li>
              </div>

              <div id="usermanagement" >
              <li class="sub-menu" >
                  <a class= "" href="/source_access/add_new_authorized_personel">
                    <i class="fa fa-address-book"></i>
                    <span>Users Management</span>
                    </a>
                </li>
              </div>

              <div id="rates"  >
              <li class="sub-menu" >
                  <a class= "" href="/source_access/update-revenue-code">
                    <i class="fa fa-address-book"></i>
                    <span>Rates Management</span>
                    </a>
              </li>
              </div>

              <div  id="backupdatabase"  >
              <li class="sub-menu">
                  <!--Temporary disabled -->
                  <!--<a href="">
                    <i class="fa fa-database"></i>
                    <span>Backup Database</span>
                    </a> -->
                  <ul class="sub">
                    <li><a href="html/daily_data">Daily Data</a></li>
                    <li><a href="">Weekly Data</a></li>
                    <li><a href="">Monthly Data</a></li>
                    <li><a href="">Yearly Data</a></li>
                  </ul>
              </li>
          </div> 
            
      </div>
      
      <script>
          function show(){
          var usertype = "{{ context.UserType }}";
          
          document.getElementById("rates").style.display = 'none';
          document.getElementById("usermanagement").style.display = 'none';
          document.getElementById("backupdatabase").style.display = 'none';
          document.getElementById("manage_account").style.display = 'none';
          document.getElementById("input_reading").style.display = 'none';
          document.getElementById("application").style.display = 'none';
          document.getElementById("reports").style.display = 'none';
          
          //admin
          if(usertype.includes("1") === true){
              document.getElementById("rates").style.display = 'block';
              document.getElementById("usermanagement").style.display = 'block';
              document.getElementById("backupdatabase").style.display = 'block';

          }
          //Teller
          if(usertype.includes("2") === true){
                document.getElementById("manage_account").style.display = 'block';
                document.getElementById("reports").style.display = 'block';
                document.getElementById("input_reading").style.display = 'block';
                document.getElementById("application").style.display = 'none';
                document.getElementById("billspayment").style.display = 'block'
                //document.getElementById("modification").style.display = 'block'

            }
          //Supervisor
          if(usertype.includes("3") === true){
              document.getElementById("manage_account").style.display = 'block';
              document.getElementById("reports").style.display = 'block';
              document.getElementById("input_reading").style.display = 'block';
              document.getElementById("application").style.display = 'block';
          } 
          //Manager
          if(usertype.includes("4") === true){
              document.getElementById("application").style.display = 'block';
              document.getElementById("reports").style.display = 'block';
          
          //meter reader
          if(usertype == "5"){
              document.getElementById("input_reading").style.display = 'block'; 
          }
      

          }
      };
      </script>
  </aside>
    <form  action="/source_access/report-data">
      <script>
        function convertToArray(obj) {
        return Object.keys(obj).map(function(key) {
            return obj[key];
        });
      }
      </script>
      <!--Monthly Report-->
      <section>
        <br>
        <br>
        <br>
      <canvas id="monthly_usage" width="800" height="150"></canvas>
      </section>
      <script>
      var chart = new Chart("monthly_usage", {
      type: 'bar',
      data: {
        labels: ["January", "February", "March", "April","May","June","July","August","September","October","November","December"],
        datasets: [
          {
            label: "Total Usage",
            backgroundColor: "#3090C7",
            data: ["{{ report.usage_january }}","{{ report.usage_february }}","{{ report.usage_march }}","{{ report.usage_april }}",
                  "{{ report.usage_may }}","{{ report.usage_june }}","{{ report.usage_july }}","{{ report.usage_august }}",
                  "{{ report.usage_september }}","{{ report.usage_october }}","{{ report.usage_november }}","{{ report.usage_december }}"]
          }
  
        ]
      },
   
      options: {
        title: {
          display: true,
          text: 'Monthly Usage This Year',
        },
      scales: {
        xAxes: [{
          ticks: {
            beginAtZero: true
          }
        }]
      }
  
  }
  });
  </script>
  
  
  <br>
  <br>
    <section>
    <canvas id="monthly_report" width="800" height="150"></canvas>
    </section>

    <script>
        var chart = new Chart("monthly_report", {
    type: 'bar',
    data: {
      labels: ["January", "February", "March", "April","May","June","July","August","September","October","November","December"],
      datasets: [
        {
          label: "Total Collectibles",
          backgroundColor: "#2B65EC",
          data: [parseFloat("{{ report.total_due_january }}") + parseFloat("{{ report.total_paid_january }}"), parseFloat("{{ report.total_due_february }}") + parseFloat("{{ report.total_paid_february }}"),
          parseFloat("{{ report.total_due_march }}") + parseFloat("{{ report.total_paid_march }}"), parseFloat("{{ report.total_due_april }}") + parseFloat("{{ report.total_paid_april }}"),
          parseFloat("{{ report.total_due_may }}") + parseFloat("{{ report.total_paid_may }}"), parseFloat("{{ report.total_due_june }}") + parseFloat("{{ report.total_paid_june }}"),
          parseFloat("{{ report.total_due_july }}") + parseFloat("{{ report.total_paid_july }}"), parseFloat("{{ report.total_due_august }}") + parseFloat("{{ report.total_paid_august }}"),
          parseFloat("{{ report.total_due_september }}") + parseFloat("{{ report.total_paid_september }}"), parseFloat("{{ report.total_due_october }}") + parseFloat("{{ report.total_paid_october }}"),
          parseFloat("{{ report.total_due_november }}") + parseFloat("{{ report.total_paid_november }}"),parseFloat("{{ report.total_due_december }}") + parseFloat("{{ report.total_paid_december }}")]
          
        }, 
        {
          label: "Total Collected",
          backgroundColor: "#3BB9FF",
          data: ["{{ report.total_paid_january }}","{{ report.total_paid_february }}","{{ report.total_paid_march }}","{{ report.total_paid_april }}",
                "{{ report.total_paid_may }}","{{ report.total_paid_june }}","{{ report.total_paid_july }}","{{ report.total_paid_august }}",
                "{{ report.total_paid_september }}","{{ report.total_paid_october }}","{{ report.total_paid_november }}","{{ report.total_paid_december }}"]
        },
        {
          label: "Total Uncollected",
          backgroundColor: "#82CAFF",
          data: ["{{ report.total_due_january }}","{{ report.total_due_february }}","{{ report.total_due_march }}","{{ report.total_due_april }}",
                "{{ report.total_due_may }}","{{ report.total_due_june }}","{{ report.total_due_july }}","{{ report.total_due_august }}",
                "{{ report.total_due_september }}","{{ report.total_due_october }}","{{ report.total_due_november }}","{{ report.total_due_december }}"]
        }

      ]
    },
    options: {
      title: {
        display: true,
        text: 'Monthly Revenue This Year'
      }
    }
});
</script>


<br>
<br>
<section>
  <canvas id="barangay_usage" width="800" height="150"></canvas>
  </section>

  <script>
    var  brgy_usage = JSON.parse("{{ brgy_usage }}".split(","));
    brgy_usage = convertToArray(brgy_usage)
    var chart = new Chart('barangay_usage', {
    type: 'bar',
    data: {
      labels: ['Anao','Cagsing','Calabawan','Cambagte','Campisong','Cañorong',
                'Guiwanon','Looc','Malatbo','Mangaco','Palanas','Poblacion',
                'Salamanca','San Roque'],

      datasets: [
        {
          data: brgy_usage,
          backgroundColor: '#3090C7',
          label: 'Total Usage'
        },
  
      ]
    },
    
    options: {
      title:{
        display: true,
        text: 'Barangay Usage'
      
     
        
      
    }
    }
  });
  </script>
  
  <br>
  <br>
  
<section>
      <canvas id="barangay_report" width="800" height="150"></canvas>
</section>

<script>
      

    var brgy_due = JSON.parse("{{brgy_due}}".split(","));
    var brgy_paid = JSON.parse("{{brgy_paid}}".split(","));
    brgy_due = convertToArray(brgy_due);
    brgy_paid = convertToArray(brgy_paid);

  var chart = new Chart('barangay_report', {
  type: 'bar',
  data: {
    labels: ['Anao','Cagsing','Calabawan','Cambagte','Campisong','Cañorong',
                'Guiwanon','Looc','Malatbo','Mangaco','Palanas','Poblacion',
                'Salamanca','San Roque'],
    datasets: [
      {
      data: [brgy_due[0] + brgy_paid[0], brgy_due[1] + brgy_paid[1], brgy_due[2] + brgy_paid[2], brgy_due[3] + brgy_paid[3],
            brgy_due[4] + brgy_paid[4], brgy_due[5] + brgy_paid[5], brgy_due[6] + brgy_paid[6], brgy_due[7] + brgy_paid[7],
            brgy_due[8] + brgy_paid[8], brgy_due[9] + brgy_paid[9], brgy_due[10] + brgy_paid[10], brgy_due[11] + brgy_paid[11],
            brgy_due[12] + brgy_paid[12], brgy_due[13] + brgy_paid[13], 
      ],
        backgroundColor: '#2B65EC',
        label: 'Total Collectibles'
      },

      {
        data: brgy_paid,
        backgroundColor: '#3BB9FF',
        label: 'Total Collected'
      },

      {
        data: brgy_due,       
        backgroundColor: '#82CAFF',
        label: 'Total Uncollected'
      },
    ]
  },
  options: {
    title:{
        display: true,
        text: 'Barangay Revenue',
    },
    scales: {
      xAxes: [{
        ticks: {
          beginAtZero: true
        }
      }]
    }
  }
});


</script>
<p id="show"></p>
</form>
 <!-- js placed at the end of the document so the pages load faster -->
 <script src="{% static 'website/lib/jquery/jquery.min.js' %}"></script>

 <script src="{% static 'website/lib/bootstrap/js/bootstrap.min.js' %}"></script>
 <script class="include" type="text/javascript" src="{% static 'website/lib/jquery.dcjqaccordion.2.7.js' %} "></script>
 <script src="{% static 'website/lib/jquery.scrollTo.min.js' %}"></script>
 <script src="{% static 'website/lib/jquery.nicescroll.js' %}" type="text/javascript"></script>
 <script src="{% static 'website/lib/jquery.sparkline.js' %}"></script>
 <script src="{% static 'website/lib/common-scripts.js' %}"></script>
 <script type="text/javascript" src="{% static 'website/lib/gritter/js/jquery.gritter.js' %}"></script>
 <script type="text/javascript" src="{% static 'website/lib/gritter-conf.js' %}"></script>
</body>
</html>